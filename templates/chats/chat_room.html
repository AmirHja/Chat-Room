{% block content %}
<h2>Chat Room: {{ room_name }}</h2>
<div id="chat-log"></div>
<input id="chat-message-input" type="text">
<button id="chat-message-submit">Send</button>

<script>
    const roomName = "{{ room_name }}";
    const ws = new WebSocket("ws://" + window.location.host + "/ws/chat/" + roomName + "/");

    ws.onmessage = function(event) {
        const data = JSON.parse(event.data);
        document.querySelector("#chat-log").innerHTML += `<p><b>${data.username}:</b> ${data.message}</p>`;
    };

    document.querySelector("#chat-message-submit").onclick = function() {
        const messageInput = document.querySelector("#chat-message-input");
        const message = messageInput.value;
        ws.send(JSON.stringify({ "message": message }));
        messageInput.value = "";
    };
</script>
{% endblock %}
